function finishRedirect(){updateSession("gameStateOnGoing","No"),sessionStorage.clear(),window.location="feedback"}function alertPopUp(){alert("You've finished the game! You will be directed to the feedback page in 3 seconds")}function shuffle(e){for(var t,s=e.length,a=0;s--;)a=Math.floor(Math.random()*(s+1)),t=e[s],e[s]=e[a],e[a]=t;return e}function updateSession(e,t){sessionStorage.setItem(e,t),$.ajax({method:"POST",url:"updateSession?key="+e+"&value="+t,data:{key:e,value:t,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(e){console.log(e)}})}var numOfCard,finalUrl,cardImage,cardQuestion,cardIndex,cardID,numOfCardOpened=0,noRepeatArray=[];$(document).ready(()=>{$(".readMore").click(function(e){"none"===$(".dots").css("display")?($(".dots").css("display","inline"),$(".readMore").text("Read more"),$(".more").css("display","none")):($(".dots").css("display","none"),$(".readMore").text("Read less"),$(".more").css("display","inline"))}),$(".expand").click(function(e){$(this).parents("div.item-details.text-center");var t=$(this).parents("div.item-details.text-center").children("span.dots2"),s=$(this).parents("div.item-details.text-center").children("span.more2");"none"===t.css("display")?(t.css("display","inline"),$(this).text("▼"),s.css("display","none")):(t.css("display","none"),$(this).text("▲"),s.css("display","inline"))}),$(".playNowButton").click(function(e){window.location.pathname="/play/"}),$("#logoHome").click(function(e){window.location.pathname="/"}),$("#reportCard").click(function(e){e.preventDefault(),$.ajax({method:"GET",url:"report?id="+cardID+"&question="+cardQuestion,success:function(e){}})}),$("#formReport").click(function(e){var t=$("#issueForm").val(),s=$("#descForm").val();console.log("masuk"),e.preventDefault(),$.ajax({method:"POST",data:{pack:sessionStorage.getItem("pack"),issue:t,desc:s,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},url:"",success:function(e){e.success?($("#descForm").empty(),$("#issueForm").empty(),alert("[SUCCESS] Thank you for letting us know! Enjoy your game! (This tab will close automatically)"),window.top.close()):($("#descForm").empty(),$("#issueForm").empty(),alert("Oops! I think there's a problem... Please try again. (This tab will close automatically)"),window.top.close())}})}),$("#customers-testimonials").owlCarousel({loop:!1,center:!1,items:3,margin:30,autoplay:!0,dots:!0,nav:!0,autoplayTimeout:8500,smartSpeed:450,navText:['<i class="fa fa-angle-left"></i>','<i class="fa fa-angle-right"></i>'],responsive:{0:{items:1},768:{items:2},1170:{items:3}}}),$("#cardHero").owlCarousel({loop:!0,center:!0,items:1,margin:30,autoplay:!0,dots:!0,nav:!0,autoplayTimeout:8500,smartSpeed:450,navText:['<i class="fa fa-angle-left"></i>','<i class="fa fa-angle-right"></i>'],responsive:{0:{items:1},768:{items:2},1170:{items:3}}}),$("#cardpack-carousel").owlCarousel({items:1,loop:!0,center:!0,margin:10,callbacks:!0,URLhashListener:!0,autoplayHoverPause:!0,startPosition:"URLHash",responsive:{0:{items:1},768:{items:2},1170:{items:3}}}),$(window).width()>992&&($("#shownCard").tilt({scale:1.02}),$(".js-tilt").tilt({scale:1.2,glare:!0,maxGlare:.11}),$(".img-responsive").tilt({scale:1.2,glare:!0,maxGlare:.11}),$(".img-responsive").hover(function(){$(this).css("border-radius","10px")},function(){$(this).css("border-radius","0")}));var e=document.getElementById("myModal");$(".close").click(function(t){t.preventDefault(),e.style.display="none",numOfCardOpened==sessionStorage.getItem("numOfCard")&&"block"!=e.style.display&&(setTimeout(alertPopUp,2e3),setTimeout(finishRedirect,3e3))}),$(".modal-close").click(function(e){console.log("kena lo"),numOfCardOpened!=sessionStorage.getItem("numOfCard")&&"hidden"!=$(".modal-window").css("visibility")||(console.log("MASHOK"),setTimeout(alertPopUp,2e3),setTimeout(finishRedirect,3e3))}),window.onclick=function(t){t.target==e&&(e.style.display="none",numOfCardOpened==sessionStorage.getItem("numOfCard")&&"block"!=e.style.display&&(setTimeout(alertPopUp,2e3),setTimeout(finishRedirect,3e3)))},$(".cardpack").click(function(e){$(this).css("transition","transform 0.8s"),$(this).css("transform-style","preserve-3d"),$(this).css("transform","rotateY(180deg)")}),$(".js-tilt").click(function(t){$(window).width()>768?(t.preventDefault(),window.onbeforeunload=null,$(window).bind("beforeunload",function(){return!1}),$(this).css("transition","transform 0.8s"),$(this).css("transform-style","preserve-3d"),$(this).css("transform","rotateY(180deg)"),$(this).replaceWith('<div class="padding-y"><img src="/static/images/empty.svg" style="width: 250px; max-height: 250px;"></div>'),e.style.display="block"):(window.onbeforeunload=null,$(window).bind("beforeunload",function(){return!1}),$(this).css("transition","transform 0.8s"),$(this).css("transform-style","preserve-3d"),$(this).css("transform","rotateY(360deg)")),numOfCardOpened++,console.log(numOfCardOpened+" dari "+sessionStorage.getItem("numOfCard")),"Two"==sessionStorage.getItem("Players")?(player=numOfCardOpened%2!=0?sessionStorage.getItem("firstPlayer"):sessionStorage.getItem("secondPlayer"),$(".playerTurn").text(player)):"Multi"==sessionStorage.getItem("Players")&&($(".multiHide").css("display","none"),$(window).width()<768&&$(".shownCard").removeClass("center")),$.ajax({method:"GET",url:"openCard?pack="+sessionStorage.getItem("pack"),success:function(e){if(!1===e.success)updateSession("gameStateOnGoing","No"),window.location="/";else{var t=JSON.parse(e);1==numOfCardOpened&&(noRepeatArray=Array.from(Array(t.length-1).keys()),shuffle(noRepeatArray)),$(this).css("transform","rotateY(-360deg)"),cardIndex=noRepeatArray[numOfCardOpened-1],cardID=t[cardIndex].pk,cardQuestion=t[cardIndex].fields.question,cardImage=t[cardIndex].fields.image,$(".shownCard").attr("src",cardImage)}}})}),$("#numOfPlayer").on("change",function(e){e.preventDefault(),$("#pack").val("");var t=this.value;"Two Players"==t?($(".playerName").toggleClass("show"),$("#DigDeeperOption").removeAttr("disabled"),$("#DigDeeperOption").css("color","#495057"),$("#LoveBirdsOption").removeAttr("disabled"),$("#LoveBirdsOption").css("color","#495057")):($(".playerName").removeClass("show"),$("#DigDeeperOption").attr("disabled","disabled"),$("#DigDeeperOption").css("color","#d3d3d3"),$("#LoveBirdsOption").attr("disabled","disabled"),$("#LoveBirdsOption").css("color","#d3d3d3"))}),$("#pack").on("change",function(e){e.preventDefault();var t=this.value;"Dig Deeper"==t?($(".level").toggleClass("show"),level=$("#levelSelection").val()):$(".level").removeClass("show")}),$("#formGamePlayButton").click(function(e){e.preventDefault(),sessionStorage.setItem("gameStateOnGoing","Yes");var t=$("#pack").val(),s=$("#levelSelection").val();if(numOfCard=$("#numOfCardSelection").val(),sessionStorage.setItem("numOfCard",numOfCard),"Two Players"==$("#numOfPlayer").val()){sessionStorage.setItem("Players","Two"),$(".playerName").toggleClass(".show");var a=$("#firstPlayer").val(),o=$("#secondPlayer").val(),n=a.substring(0,36),i=o.substring(0,36);console.log(n);var r=""!=$("#firstPlayer").val()?sessionStorage.setItem("firstPlayer",n):sessionStorage.setItem("firstPlayer","Player 1"),l=""!=$("#secondPlayer").val()?sessionStorage.setItem("secondPlayer",i):sessionStorage.setItem("secondPlayer","Player 2");finalUrl="form?pack="+t+"&firstPlayer="+r+"&secondPlayer="+l}else{if("Multi Players"!=$("#numOfPlayer").val())return void alert("Please select one 'Number of Players'");sessionStorage.setItem("Players","Multi"),finalUrl="form?pack="+t}if("Dig Deeper"==t)3==s?sessionStorage.setItem("pack","DigDeeper3"):2==s?sessionStorage.setItem("pack","DigDeeper2"):1==s&&sessionStorage.setItem("pack","DigDeeper1");else if("Break the Ice: Let the Fun Begin!"==t)sessionStorage.setItem("pack","IceBreak");else if("Mix & Match"==t)sessionStorage.setItem("pack","MixNMatch");else if("Lovebirds Edition"==t)sessionStorage.setItem("pack","Lovebirds");else if("Hello Nice to Meet You, Stranger"==t)sessionStorage.setItem("pack","Stranger");else{if("Perspective"!=t)return void alert("Please select one 'Card Pack'");sessionStorage.setItem("pack","Perspective")}$.ajax({method:"POST",url:finalUrl,data:{pack:t,gameStateOnGoing:"Yes",csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(e){window.location="/play"}})}),$("#showCard").click(function(e){if(e.preventDefault(),null!=sessionStorage.getItem("gameStateOnGoing"))if("Yes"===sessionStorage.getItem("gameStateOnGoing")){var t=sessionStorage.getItem("numOfCard");12==t?$("#gamePlace12").toggleClass("hidden"):16==t?$("#gamePlace16").toggleClass("hidden"):20==t&&$("#gamePlace20").toggleClass("hidden")}else alert("Oops! There's something wrong here... You'll be directed to the form page"),window.location="/play";else alert("Oops! There's something wrong here... You'll be directed to the form page"),window.location="/play"}),$("#finishButton").click(function(e){e.preventDefault(),window.onbeforeunload=null;var t=confirm("Oops! You haven't picked all the cards yet. Are you sure you want to finish the game?");1==t&&finishRedirect()}),$("#terminateLink").click(function(e){e.preventDefault(),window.onbeforeunload=null,sessionStorage.clear(),window.location="/"}),$(".nav-link").click(function(e){if(e.preventDefault(),window.onbeforeunload=null,$(this).addClass("active"),null!=sessionStorage.getItem("gameStateOnGoing"))if("Yes"===sessionStorage.getItem("gameStateOnGoing")&&"/play/"===window.location.pathname){var t=confirm("Oops! You still have a game going on. Do you wish to terminate the game?");1==t&&(e.preventDefault(),updateSession("gameStateOnGoing","No"),sessionStorage.clear(),"playNavBar"==$(this).attr("id")?window.location="form":window.location=$(this).attr("href"))}else window.location=$(this).attr("href");else window.location=$(this).attr("href")}),$(".link").click(function(e){e.preventDefault(),window.open($(this).attr("href"),"_blank")}),$(".linkin").click(function(e){window.location=$(this).attr("href")})});